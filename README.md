# 🎴 かるた配置サポーター (Supabase連携版)

競技かるたの自陣25枚の配置をシミュレーションし、クラウド保存や統計的な傾向分析を行うためのWebアプリケーションです。
自分の配置のクセを可視化し、より戦略的な盤面構成と暗記の定着をサポートします。

## 🔗 アプリURL
以下のリンクからすぐに試用いただけます：  
**https://blank-app-u3tovtui7a.streamlit.app/** *(※スリープ状態のときは、画面中央のボタンを押して起動してください)*

---

## ✨ 主な機能

### 1. 札の選択と管理
- 百人一首100枚の中から自陣の25枚を直感的に選択。
- 一字決まり、二字決まり、大山札などの条件で素早く絞り込みが可能。

### 2. スマートな盤面配置
- 6つのエリア（上段・中段・下段（左右））に札を振り分け。
- **重複選択防止機能**: 一度配置した札は他の段の選択肢から自動で除外されるため、配置ミスが起こりません。

### 3. 配置診断アドバイス
- 競技かるたの定石（一字決まりの下段配置、友札の左右分離など）に基づき、現在の配置を自動でアドバイス。
- 「一字決まりが下段にあるか」「友札が左右に分かれているか」などのアドバイスを表示。

### 4. データの保存・ロード (Supabase連携)
- 作成した配置に名前をつけてクラウドへ保存。大会用や練習用など、複数のパターンをいつでもロード可能。
- 過去の配置をいつでも呼び出して再確認・修正が可能。

### 5. 傾向分析
- 保存されたデータから、どの札をどの位置に置く傾向があるかを統計的に集計し、ヒートマップで視覚化。
- 自分の得意・不得意な配置パターンを客観的に振り返ることができます。

---

## 🛠 セットアップ方法

### 1. 依存ライブラリのインストール
Python環境がインストールされていることを確認し、以下のコマンドを実行してください。

```bash
pip install streamlit pandas supabase plotly
```bash

### 2. データの準備
プロジェクトのルートディレクトリに `fuda.json` （百人一首のデータファイル）が配置されていることを確認してください。このファイルはアプリが札情報を読み込むために必須となります。


**ディレクトリ構成の確認:**
.
├── streamlit_app.py  # アプリ本体
├── fuda.json         # 札データ（必須）
└── requirements.txt  # ライブラリ一覧

### 3. アプリの起動
ターミナルで以下のコマンドを実行し、ローカル環境でブラウザを立ち上げてアプリを起動します。

```bash
streamlit run streamlit_app.py
```bash

---

## 📊 データの仕組み

このアプリは **Supabase (PostgreSQL)** を使用してデータを永続化しています。

* **karuta_decks**: 保存された配置（デッキ名、25枚のリスト、各段の配置詳細、作成日時）を管理。
* **fuda.json**: 100首の基本データ（決まり字、下の句、札タイプ）を保持。

---

## 💻 使用技術

本プロジェクトでは、迅速な開発とデータ分析の両立を目的として、以下のテクノロジースタックを採用しています。

* **UI / Web Framework**: [Streamlit](https://streamlit.io/) - Pythonのみでインタラクティブかつ直感的なUIを構築。
* **Database**: [Supabase](https://supabase.com/) - クラウド上のPostgreSQLを利用し、セキュアでリアルタイムなデータ保存を実現。
* **Data Visualization**: [Plotly Express](https://plotly.com/python/) - 配置のクセを視覚化するための動的ヒートマップを作成。
* **Data Handling**: [Pandas](https://pandas.pydata.org/) - 保存データの集計および多次元的な傾向分析。

---

## 🚀 今後のロードマップ（機能拡張案）

競技かるたの競技力向上により特化した機能を順次追加予定です。

- **📸 配置図の画像書き出し機能**
    - ボタン一つで自陣の配置を画像（PNG/JPG）として保存し、SNS共有や印刷を可能にします。
- **🕵️ 対戦相手の配置分析**
    - 自陣だけでなく、対戦相手の配置も記録・蓄積することで、効果的な「送り札」の戦略を最適化します。
- **🧠 暗記確認テストモード**
    - 配置した札の「下の句」を一時的に非表示にし、盤面の暗記精度をセルフチェックできるトレーニング機能。
- **📉 経時的な配置の変遷グラフ**
    - 過去から現在にかけて、自分の配置スタイルがどのように変化・進化したかを時系列で追跡します。

---
